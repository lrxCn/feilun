var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r;"undefined"!=typeof require&&require;import{r as c,R as a,u as i,J as u,F as m,H as d,L as p,S as E,a as f,b as h,c as g}from"./vendor.37eb63c7.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var y=(e={})=>{var i;const u=c.exports.useRef(0),[m,d]=c.exports.useState(e.src||(null==(i=e.srclist)?void 0:i[u.current++||0]));return a.createElement("img",(p=((e,t)=>{for(var n in t||(t={}))s.call(t,n)&&o(e,n,t[n]);if(r)for(var n of r(t))l.call(t,n)&&o(e,n,t[n]);return e})({},e),t(p,n({src:m,onError:()=>{const t=e.srclist[u.current++||0];t&&d(t)}}))));var p};const v="https://img.icons8.com/glyph-neue/2x/easy.png",b="https://www.easyicon.cc/icon/tabler-icons/node_modules/@tabler/icons/icons/mood-smile.svg";const w=()=>{},x=async(e,t)=>(await((e=1e3)=>new Promise((t=>setTimeout(t,e))))(t),e);var k=({killMyself:e=w})=>{const[t,n]=c.exports.useState(0);return c.exports.useEffect((()=>{x("response",1e3).then(n),setTimeout(e,500)}),[]),a.createElement("div",null,"child: ",t)},O=({killMyself:e=w})=>{const[t,n]=(e=>{const[t,n]=c.exports.useState(e),r=c.exports.useRef(!1);return c.exports.useEffect((()=>()=>r.current=!0)),[t,r.current?w:n]})(0);return c.exports.useEffect((()=>{x("response",1e3).then(n),setTimeout(e,500)}),[]),a.createElement("div",null,"child: ",t)};const S=({get:e,set:t})=>({count:1,increase(){const{count:n}=e();t({count:n+1})},decrease(){const{count:n}=e();t({count:n-1})}});var C=()=>{const{count:e,increase:t,decrease:n}=i(S);return a.createElement("div",null,a.createElement("p",null,e),a.createElement("button",{onClick:n},"minus"))},L=()=>{const{count:e,increase:t,decrease:n}=i(S);return a.createElement("div",null,a.createElement("p",null,e),a.createElement("button",{onClick:t},"add"))};const N=e=>e.substring(e.lastIndexOf("/")+1),j=(e="")=>{const t=N(e),n=t.split(".").pop()||"png",r=document.createElement("canvas"),s=document.createElement("img");s.onload=()=>{r.width=s.width,r.height=s.height;r.getContext("2d").drawImage(s,0,0,s.width,s.height),r.getContext("2d").drawImage(s,0,0,s.width,s.height),r.toBlob((e=>{const n=document.createElement("a");n.href=window.URL.createObjectURL(e),n.download=t,n.click()}),`image/${n}`)},s.setAttribute("crossOrigin","Anonymous"),s.src=e},P=(e,t="打包下载")=>{if(!(e.length>0))return;const n=new u,r={},s=e.map((e=>{return(t=e,new Promise((e=>{const n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=()=>200===n.status&&e(n.response),n.send()}))).then((t=>{const s=N(e);n.file(s,t,{binary:!0}),r[s]=t}));var t}));Promise.all(s).then((()=>{n.generateAsync({type:"blob"}).then((e=>{m.saveAs(e,`${t}.zip`)}))}))},R=e=>{Array.isArray(e)?e.length>1?P(e):j(e.slice(0).pop()):j(e)};const q="/2.jpeg",A="/3.jpeg";var I=[{route:"/safeImage",Component:()=>a.createElement("div",null,a.createElement("h6",null,"可以当做正常的img使用"),a.createElement(y,{src:v,className:"outline square-100",alt:"hand"}),a.createElement("hr",null),a.createElement("h6",null,"也可以不传src 只穿srclist"),a.createElement(y,{srclist:[v,b],className:"square-100"}),a.createElement("hr",null),a.createElement("h6",null,"当srclist第一个地址报错的时候，会尝试使用第二个"),a.createElement(y,{srclist:[`mass${v}`,b],className:"square-100"}),a.createElement("hr",null),a.createElement("h6",null,"src 和 srclist 可以一起使用，src优先级高于srcList"),a.createElement(y,{src:`mass${b}`,srclist:[v,b],className:"square-100"}),a.createElement("hr",null))},{route:"/setState",title:"安全的setState",Component:()=>{const[e,t]=c.exports.useState(!0),[n,r]=c.exports.useState(!0);return a.createElement("div",null,a.createElement("h6",null,"当子组件卸载发生在setState之前，控制台就会报一个warning: Can't perform a React state update on an unmounted component."),e&&a.createElement(k,{killMyself:()=>t(!1)}),a.createElement("hr",null),a.createElement("h6",null,"如果使用useSafeState就不会有这样的问题"),n&&a.createElement(O,{killMyself:()=>r(!1)}),a.createElement("hr",null))}},{route:"/flooks",title:"数据流",Component:()=>a.createElement("div",{className:"App"},a.createElement(L,null),a.createElement(C,null))},{route:"/download",title:"批量下载图片",Component:()=>a.createElement("div",{className:"con-download"},a.createElement("div",{className:"con-download-btn",onClick:()=>{R(q)}},"down1"),a.createElement("div",{className:"con-download-btn",onClick:()=>{R([q,A])}},"down2"))}],M=()=>{const e=c.exports.useRef(((e=[],t)=>e.reduce(((e,n)=>Object.assign(e,{[n[t]]:n})),{}))(I,"route")),t=()=>{var t;const{route:n,title:r=n.slice(1)}=null==(t=e.current)?void 0:t[location.hash.slice(1)];document.title=r};return((e,t,n=window)=>{const r=c.exports.useRef();c.exports.useEffect((()=>{r.current=t}),[t]),c.exports.useEffect((()=>{if(!n||!n.addEventListener)return;const t=e=>r.current(e);return n.addEventListener(e,t),()=>{n.removeEventListener(e,t)}}),[e,n])})("hashchange",t),c.exports.useEffect(t,[]),a.createElement(d,null,a.createElement("div",{className:"con"},a.createElement("ul",null,I.map((({title:e,route:t})=>a.createElement("li",{key:t},a.createElement(p,{to:t},e||t.slice(1)))))),a.createElement(E,null,I.map((({route:e,Component:t})=>a.createElement(f,{key:e,path:e,component:t}))),a.createElement(h,{path:"/",to:I[0].route}))))};g.render(a.createElement(a.StrictMode,null,a.createElement(M,null)),document.getElementById("root"));
